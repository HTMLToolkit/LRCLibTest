(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))y(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const v of o.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&y(v)}).observe(document,{childList:!0,subtree:!0});function p(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function y(i){if(i.ep)return;i.ep=!0;const o=p(i);fetch(i.href,o)}})();(function(){const L="https://lrcgetter-backend.neeljaiswal23.workers.dev/api",n=e=>document.querySelector(e),p=e=>document.querySelectorAll(e);let y=null,i=!1;p(".nav-link[data-view]").forEach(e=>{e.addEventListener("click",s=>{s.preventDefault();const t=e.dataset.view;p(".nav-link").forEach(a=>a.classList.remove("active")),e.classList.add("active"),p(".view").forEach(a=>a.classList.remove("active")),n(`#view-${t}`).classList.add("active")})}),p(".tab").forEach(e=>{e.addEventListener("click",()=>{const s=e.dataset.tab;p(".tab").forEach(t=>t.classList.remove("active")),e.classList.add("active"),p(".tab-content").forEach(t=>t.classList.remove("active")),n(`#tab-${s}`).classList.add("active")})});async function o(e,s={}){const t=L+e,a={Accept:"application/json",...s.headers};let r;try{r=await fetch(t,{...s,headers:a})}catch(d){throw console.error("Network error:",d),{status:0,data:{message:"Network error - check your connection or the API may be down"}}}const l=await r.text();let c;try{c=JSON.parse(l)}catch{c={message:l||"Unknown error"}}if(!r.ok)throw{status:r.status,data:c};return c}function v(e){return Object.entries(e).filter(([s,t])=>t!=null&&t!=="").map(([s,t])=>`${encodeURIComponent(s)}=${encodeURIComponent(t)}`).join("&")}function g(e){e.innerHTML=`
      <div class="loading">
        <div class="spinner"></div>
        <span>Loading...</span>
      </div>
    `}function m(e,s){e.innerHTML=`<div class="message error">${f(s)}</div>`}function w(e,s){e.innerHTML=`<div class="message success">${f(s)}</div>`}function f(e){if(e==null)return"";const s=document.createElement("div");return s.textContent=String(e),s.innerHTML}function $(e){const s=Math.floor(e/60),t=e%60;return`${s}:${t.toString().padStart(2,"0")}`}function h(e){return e.data?.message?e.data.message:e.data?.error?e.data.error:typeof e.data=="string"&&e.data?e.data:e.message?e.message:e.status?`HTTP Error ${e.status}`:"An unknown error occurred"}function b(e,s){if(!e){m(s,"No lyrics found");return}const t=e.syncedLyrics&&e.syncedLyrics.trim(),a=e.plainLyrics&&e.plainLyrics.trim();let r="";t&&(r=e.syncedLyrics.split(`
`).filter(d=>d.trim()).map(d=>{const u=d.match(/^\[(\d{2}:\d{2}\.\d{2})\]\s*(.*)$/);return u?`<div class="synced-line"><span class="timestamp">[${u[1]}]</span><span>${f(u[2])}</span></div>`:`<div>${f(d)}</div>`}).join(""));const l=a?`<pre>${f(e.plainLyrics)}</pre>`:'<p class="muted">No plain lyrics available</p>';s.innerHTML=`
      <div class="lyrics-display">
        <div class="lyrics-header">
          <h2>${f(e.trackName)}</h2>
          <p>${f(e.artistName)} — ${f(e.albumName)}</p>
          <div class="result-meta" style="margin-top: 12px;">
            <span class="result-badge">${$(e.duration)}</span>
            ${t?'<span class="result-badge synced">Synced</span>':""}
            ${e.instrumental?'<span class="result-badge instrumental">Instrumental</span>':""}
            <span class="result-badge">ID: ${e.id}</span>
          </div>
        </div>
        <div class="lyrics-tabs">
          <button class="lyrics-tab ${t?"active":""}" data-lyrics="synced" ${t?"":"disabled"}>Synchronized</button>
          <button class="lyrics-tab ${t?"":"active"}" data-lyrics="plain">Plain</button>
        </div>
        <div class="lyrics-content">
          <div id="lyrics-synced" ${t?"":'style="display: none"'}>${r||'<p class="muted">No synchronized lyrics available</p>'}</div>
          <div id="lyrics-plain" ${t?'style="display: none"':""}>${l}</div>
        </div>
      </div>
    `,s.querySelectorAll(".lyrics-tab").forEach(c=>{c.addEventListener("click",()=>{if(c.disabled)return;s.querySelectorAll(".lyrics-tab").forEach(u=>u.classList.remove("active")),c.classList.add("active");const d=c.dataset.lyrics;s.querySelector("#lyrics-synced").style.display=d==="synced"?"block":"none",s.querySelector("#lyrics-plain").style.display=d==="plain"?"block":"none"})})}function S(e,s){if(!e||e.length===0){s.innerHTML='<div class="message info">No results found. Try different search terms.</div>';return}s.innerHTML=e.map(t=>{const a=t.syncedLyrics&&t.syncedLyrics.trim();return`
        <div class="result-card" data-id="${t.id}">
          <div class="result-header">
            <div>
              <div class="result-title">${f(t.trackName)}</div>
              <div class="result-artist">${f(t.artistName)}</div>
            </div>
            <div class="result-meta">
              <span class="result-badge">${$(t.duration)}</span>
              ${a?'<span class="result-badge synced">Synced</span>':""}
              ${t.instrumental?'<span class="result-badge instrumental">Instrumental</span>':""}
            </div>
          </div>
          <div class="result-album">${f(t.albumName)}</div>
        </div>
      `}).join(""),s.querySelectorAll(".result-card").forEach(t=>{t.addEventListener("click",async()=>{const a=t.dataset.id;g(s);try{const r=await o(`/get/${a}`);b(r,s)}catch(r){m(s,h(r))}})})}n("#form-search").addEventListener("submit",async e=>{e.preventDefault();const s=e.target,t=new FormData(s),a=Object.fromEntries(t.entries());if(!a.q&&!a.track_name){m(n("#search-results"),"Please provide at least a search query or track name");return}const r=n("#search-results");g(r);try{const l=v(a),c=await o(`/search?${l}`);S(c,r)}catch(l){console.error("Search error:",l),m(r,h(l))}}),n("#form-get-signature").addEventListener("submit",async e=>{e.preventDefault();const s=e.target,t=new FormData(s),a=Object.fromEntries(t.entries()),r=a.cached;delete a.cached;const l=n("#get-results");g(l);try{const c=r?"/get-cached":"/get",d=v(a),u=await o(`${c}?${d}`);b(u,l)}catch(c){c.status===404?m(l,"Track not found. Make sure all fields match exactly, including duration (±2 seconds)."):m(l,h(c))}}),n("#form-get-id").addEventListener("submit",async e=>{e.preventDefault();const s=new FormData(e.target).get("id").trim(),t=n("#get-results");g(t);try{const a=await o(`/get/${encodeURIComponent(s)}`);b(a,t)}catch(a){a.status===404?m(t,"Lyrics not found with this ID."):m(t,h(a))}}),n("#btn-challenge").addEventListener("click",async()=>{const e=n("#challenge-status");e.className="challenge-status working",e.textContent="Requesting challenge...";try{const s=await o("/request-challenge",{method:"POST"});y=s,n("#pub-prefix").value=s.prefix,n("#pub-nonce").value="",n("#btn-solve").disabled=!1,e.className="challenge-status success",e.textContent=`Challenge received! Prefix: ${s.prefix.substring(0,16)}...Target: ${s.target.substring(0,16)}...`}catch(s){e.className="challenge-status error",e.textContent="Failed to get challenge:  "+h(s)}});async function E(e){const s=new TextEncoder().encode(e),t=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}async function N(e,s,t){let a=0;const r=2048,l=Date.now();for(;!i;){for(let c=0;c<r&&!i;c++){const d=`${e}: ${a}`,u=await E(d);if(u<s.toLowerCase())return{nonce:String(a),hash:u,attempts:a+1,time:Date.now()-l};a++}t&&t(a,Date.now()-l),await new Promise(c=>setTimeout(c,0))}throw new Error("Cancelled")}n("#btn-solve").addEventListener("click",async()=>{if(!y){n("#challenge-status").textContent="Please request a challenge first";return}i=!1,n("#btn-solve").disabled=!0,n("#btn-cancel").disabled=!1;const e=n("#challenge-status");e.className="challenge-status working";try{const s=await N(y.prefix,y.target,(t,a)=>{const r=Math.round(t/(a/1e3));e.textContent=`Solving...${t.toLocaleString()} attempts (${r.toLocaleString()} H/s)`});n("#pub-nonce").value=s.nonce,e.className="challenge-status success",e.textContent=`Solved! Nonce: ${s.nonce} (${s.attempts.toLocaleString()} attempts in ${(s.time/1e3).toFixed(1)}s)`}catch(s){e.className="challenge-status error",e.textContent=s.message==="Cancelled"?"Solver cancelled":`Solver error: ${s.message}`}finally{n("#btn-solve").disabled=!1,n("#btn-cancel").disabled=!0}}),n("#btn-cancel").addEventListener("click",()=>{i=!0}),n("#form-publish").addEventListener("submit",async e=>{e.preventDefault();const s=new FormData(e.target),t=Object.fromEntries(s.entries()),a=t.prefix,r=t.nonce;if(!a||!r){m(n("#publish-results"),"Please request and solve a challenge first");return}const l=`${a}:${r}`,c={trackName:t.trackName,artistName:t.artistName,albumName:t.albumName,duration:parseInt(t.duration,10),plainLyrics:t.plainLyrics||"",syncedLyrics:t.syncedLyrics||""},d=n("#publish-results");g(d);try{await o("/publish",{method:"POST",headers:{"Content-Type":"application/json","X-Publish-Token":l},body:JSON.stringify(c)}),w(d,"Lyrics published successfully!"),y=null,n("#pub-prefix").value="",n("#pub-nonce").value="",n("#btn-solve").disabled=!0,n("#challenge-status").textContent=""}catch(u){m(d,h(u))}}),console.log("LRCGetter Frontend loaded")})();
//# sourceMappingURL=index-BvsfHFs6.js.map

{"version":3,"file":"index-DD7Yz1LG.js","sources":["../../src/main.js"],"sourcesContent":["(function () {\n  'use strict';\n\n  // Backend proxy URL - Cloudflare Worker\n  const API_BASE = 'https://lrcgetter-backend.neeljaiswal23.workers.dev/api';\n\n  // DOM helpers\n  const $ = (sel) => document.querySelector(sel);\n  const $$ = (sel) => document.querySelectorAll(sel);\n  const docEl = document.documentElement;\n  const themeLogo = $('#logo-img');\n\n  // State\n  let currentChallenge = null;\n  let solverWorking = false;\n  let solverCancel = false;\n  const THEME_STORAGE_KEY = 'lrc-theme-mode';\n  const themeButtons = $$('.theme-btn');\n  const systemDarkQuery = window.matchMedia('(prefers-color-scheme: dark)');\n  let themePreference = getStoredTheme() || 'auto';\n\n  initThemeControls();\n\n  // Navigation\n  $$('.nav-link[data-view]').forEach(link => {\n    link.addEventListener('click', (e) => {\n      e.preventDefault();\n      const view = link.dataset.view;\n\n      $$('.nav-link').forEach(l => l.classList.remove('active'));\n      link.classList.add('active');\n\n      $$('.view').forEach(v => v.classList.remove('active'));\n      $(`#view-${view}`).classList.add('active');\n    });\n  });\n\n  // Tabs in Get view\n  $$('.tab').forEach(tab => {\n    tab.addEventListener('click', () => {\n      const tabName = tab.dataset.tab;\n\n      $$('.tab').forEach(t => t.classList.remove('active'));\n      tab.classList.add('active');\n\n      $$('.tab-content').forEach(tc => tc.classList.remove('active'));\n      $(`#tab-${tabName}`).classList.add('active');\n    });\n  });\n\n  // API helpers\n  async function apiFetch(endpoint, options = {}) {\n    const url = API_BASE + endpoint;\n    const headers = {\n      'Accept': 'application/json',\n      ...options.headers\n    };\n\n    let res;\n    try {\n      res = await fetch(url, { ...options, headers });\n    } catch (networkError) {\n      console.error('Network error:', networkError);\n      throw { status: 0, data: { message: 'Network error - check your connection or the API may be down' } };\n    }\n\n    const text = await res.text();\n\n    let data;\n    try {\n      data = JSON.parse(text);\n    } catch {\n      data = { message: text || 'Unknown error' };\n    }\n\n    if (!res.ok) {\n      throw { status: res.status, data };\n    }\n\n    return data;\n  }\n\n  function buildQueryString(params) {\n    return Object.entries(params)\n      .filter(([_, v]) => v !== undefined && v !== null && v !== '')\n      .map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n      .join('&');\n  }\n\n  function getStoredTheme() {\n    try {\n      return localStorage.getItem(THEME_STORAGE_KEY);\n    } catch (err) {\n      console.warn('Unable to access stored theme preference', err);\n      return null;\n    }\n  }\n\n  function setStoredTheme(value) {\n    try {\n      localStorage.setItem(THEME_STORAGE_KEY, value);\n    } catch (err) {\n      console.warn('Unable to persist theme preference', err);\n    }\n  }\n\n  function getEffectiveTheme(pref) {\n    if (pref === 'auto') {\n      return systemDarkQuery.matches ? 'dark' : 'light';\n    }\n    return pref;\n  }\n\n  function updateLogoForTheme(effectiveTheme) {\n    if (!themeLogo) return;\n    const logoForDarkMode = themeLogo.dataset.logoLight || themeLogo.src;\n    const logoForLightMode = themeLogo.dataset.logoDark || themeLogo.src;\n    if (effectiveTheme === 'dark') {\n      themeLogo.src = logoForDarkMode;\n    } else {\n      themeLogo.src = logoForLightMode;\n    }\n  }\n\n  function applyThemePreference(pref) {\n    themePreference = pref;\n    setStoredTheme(pref);\n    const effectiveTheme = getEffectiveTheme(pref);\n    docEl.setAttribute('data-theme', effectiveTheme);\n    updateLogoForTheme(effectiveTheme);\n    themeButtons.forEach(btn => {\n      btn.classList.toggle('active', btn.dataset.themeMode === pref);\n    });\n  }\n\n  function initThemeControls() {\n    if (themeButtons.length) {\n      themeButtons.forEach(btn => {\n        btn.addEventListener('click', () => {\n          const mode = btn.dataset.themeMode || 'auto';\n          applyThemePreference(mode);\n        });\n      });\n    }\n\n    const handleSystemThemeChange = () => {\n      if (themePreference === 'auto') {\n        const effectiveTheme = getEffectiveTheme('auto');\n        docEl.setAttribute('data-theme', effectiveTheme);\n        updateLogoForTheme(effectiveTheme);\n      }\n    };\n\n    if (typeof systemDarkQuery.addEventListener === 'function') {\n      systemDarkQuery.addEventListener('change', handleSystemThemeChange);\n    } else if (typeof systemDarkQuery.addListener === 'function') {\n      systemDarkQuery.addListener(handleSystemThemeChange);\n    }\n\n    applyThemePreference(themePreference);\n  }\n\n  // UI helpers\n  function showLoading(container) {\n    container.innerHTML = `\n      <div class=\"loading\">\n        <div class=\"spinner\"></div>\n        <span>Loading...</span>\n      </div>\n    `;\n  }\n\n  function showError(container, message) {\n    container.innerHTML = `<div class=\"message error\">${escapeHtml(message)}</div>`;\n  }\n\n  function showSuccess(container, message) {\n    container.innerHTML = `<div class=\"message success\">${escapeHtml(message)}</div>`;\n  }\n\n  function escapeHtml(str) {\n    if (str === null || str === undefined) return '';\n    const div = document.createElement('div');\n    div.textContent = String(str);\n    return div.innerHTML;\n  }\n\n  function formatDuration(seconds) {\n    const m = Math.floor(seconds / 60);\n    const s = seconds % 60;\n    return `${m}:${s.toString().padStart(2, '0')}`;\n  }\n\n  function getErrorMessage(err) {\n    if (err.data?.message) return err.data.message;\n    if (err.data?.error) return err.data.error;\n    if (typeof err.data === 'string' && err.data) return err.data;\n    if (err.message) return err.message;\n    if (err.status) return `HTTP Error ${err.status}`;\n    return 'An unknown error occurred';\n  }\n\n  async function copyToClipboard(text) {\n    const payload = typeof text === 'string' ? text : String(text ?? '');\n    if (navigator.clipboard && window.isSecureContext) {\n      await navigator.clipboard.writeText(payload);\n      return;\n    }\n\n    const textarea = document.createElement('textarea');\n    textarea.value = payload;\n    textarea.style.position = 'fixed';\n    textarea.style.opacity = '0';\n    textarea.style.pointerEvents = 'none';\n    document.body.appendChild(textarea);\n    textarea.focus({ preventScroll: true });\n    textarea.select();\n    const succeeded = document.execCommand('copy');\n    document.body.removeChild(textarea);\n    if (!succeeded) {\n      throw new Error('Copy command failed');\n    }\n  }\n\n  function renderLyrics(data, container) {\n    if (!data) {\n      showError(container, 'No lyrics found');\n      return;\n    }\n\n    const hasSynced = data.syncedLyrics && data.syncedLyrics.trim();\n    const hasPlain = data.plainLyrics && data.plainLyrics.trim();\n\n    let syncedHtml = '';\n    if (hasSynced) {\n      const lines = data.syncedLyrics.split('\\n').filter(l => l.trim());\n      syncedHtml = lines.map(line => {\n        const match = line.match(/^\\[(\\d{2}:\\d{2}\\.\\d{2})\\]\\s*(.*)$/);\n        if (match) {\n          return `<div class=\"synced-line\"><span class=\"timestamp\">[${match[1]}]</span><span>${escapeHtml(match[2])}</span></div>`;\n        }\n        return `<div>${escapeHtml(line)}</div>`;\n      }).join('');\n    }\n\n    const plainHtml = hasPlain ? `<pre>${escapeHtml(data.plainLyrics)}</pre>` : '<p class=\"muted\">No plain lyrics available</p>';\n\n    container.innerHTML = `\n      <div class=\"lyrics-display\">\n        <div class=\"lyrics-header\">\n          <div class=\"track-summary\">\n            <h2>${escapeHtml(data.trackName)}</h2>\n            <p>${escapeHtml(data.artistName)} — ${escapeHtml(data.albumName)}</p>\n            <div class=\"result-meta\" style=\"margin-top: 12px;\">\n              <span class=\"result-badge\">${formatDuration(data.duration)}</span>\n              ${hasSynced ? '<span class=\"result-badge synced\">Synced</span>' : ''}\n              ${data.instrumental ? '<span class=\"result-badge instrumental\">Instrumental</span>' : ''}\n              <span class=\"result-badge\">ID: ${data.id}</span>\n            </div>\n          </div>\n          <div class=\"lyrics-actions\">\n            <button type=\"button\" class=\"btn-copy\" aria-label=\"Copy currently visible lyrics\">\n              <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n                <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\"></rect>\n                <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path>\n              </svg>\n              <span>Copy lyrics</span>\n            </button>\n          </div>\n        </div>\n        <div class=\"lyrics-tabs\">\n          <button class=\"lyrics-tab ${hasSynced ? 'active' : ''}\" data-lyrics=\"synced\" ${!hasSynced ? 'disabled' : ''}>Synchronized</button>\n          <button class=\"lyrics-tab ${!hasSynced ? 'active' : ''}\" data-lyrics=\"plain\">Plain</button>\n        </div>\n        <div class=\"lyrics-content\">\n          <div id=\"lyrics-synced\" ${!hasSynced ? 'style=\"display: none\"' : ''}>${syncedHtml || '<p class=\"muted\">No synchronized lyrics available</p>'}</div>\n          <div id=\"lyrics-plain\" ${hasSynced ? 'style=\"display: none\"' : ''}>${plainHtml}</div>\n        </div>\n      </div>\n    `;\n\n    container.querySelectorAll('.lyrics-tab').forEach(tab => {\n      tab.addEventListener('click', () => {\n        if (tab.disabled) return;\n        container.querySelectorAll('.lyrics-tab').forEach(t => t.classList.remove('active'));\n        tab.classList.add('active');\n\n        const type = tab.dataset.lyrics;\n        container.querySelector('#lyrics-synced').style.display = type === 'synced' ? 'block' : 'none';\n        container.querySelector('#lyrics-plain').style.display = type === 'plain' ? 'block' : 'none';\n      });\n    });\n\n    const copyButton = container.querySelector('.btn-copy');\n    if (copyButton) {\n      const labelSpan = copyButton.querySelector('span');\n      const defaultLabel = labelSpan ? labelSpan.textContent.trim() || 'Copy lyrics' : 'Copy lyrics';\n      const setLabel = (text) => {\n        if (labelSpan) {\n          labelSpan.textContent = text;\n        } else {\n          copyButton.textContent = text;\n        }\n      };\n\n      let resetTimer;\n      const resetState = () => {\n        copyButton.classList.remove('success');\n        setLabel(defaultLabel);\n      };\n\n      copyButton.addEventListener('click', async () => {\n        clearTimeout(resetTimer);\n        const activeTab = container.querySelector('.lyrics-tab.active');\n        const wantsSynced = activeTab?.dataset.lyrics === 'synced';\n        const textSource = wantsSynced && hasSynced ? data.syncedLyrics : data.plainLyrics;\n\n        if (!textSource || !textSource.trim()) {\n          setLabel('Nothing to copy');\n          resetTimer = setTimeout(resetState, 2000);\n          return;\n        }\n\n        try {\n          await copyToClipboard(textSource);\n          copyButton.classList.add('success');\n          setLabel('Copied!');\n        } catch (err) {\n          console.error('Copy failed:', err);\n          copyButton.classList.remove('success');\n          setLabel('Copy failed');\n        } finally {\n          resetTimer = setTimeout(resetState, 2000);\n        }\n      });\n    }\n  }\n\n  function renderSearchResults(results, container) {\n    if (!results || results.length === 0) {\n      container.innerHTML = '<div class=\"message info\">No results found. Try different search terms.</div>';\n      return;\n    }\n\n    container.innerHTML = results.map(item => {\n      const hasSynced = item.syncedLyrics && item.syncedLyrics.trim();\n      return `\n        <div class=\"result-card\" data-id=\"${item.id}\">\n          <div class=\"result-header\">\n            <div>\n              <div class=\"result-title\">${escapeHtml(item.trackName)}</div>\n              <div class=\"result-artist\">${escapeHtml(item.artistName)}</div>\n            </div>\n            <div class=\"result-meta\">\n              <span class=\"result-badge\">${formatDuration(item.duration)}</span>\n              ${hasSynced ? '<span class=\"result-badge synced\">Synced</span>' : ''}\n              ${item.instrumental ? '<span class=\"result-badge instrumental\">Instrumental</span>' : ''}\n            </div>\n          </div>\n          <div class=\"result-album\">${escapeHtml(item.albumName)}</div>\n        </div>\n      `;\n    }).join('');\n\n    container.querySelectorAll('.result-card').forEach(card => {\n      card.addEventListener('click', async () => {\n        const id = card.dataset.id;\n        showLoading(container);\n        try {\n          const data = await apiFetch(`/get/${id}`);\n          renderLyrics(data, container);\n        } catch (err) {\n          showError(container, getErrorMessage(err));\n        }\n      });\n    });\n  }\n\n  // Search form\n  $('#form-search').addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const form = e.target;\n    const formData = new FormData(form);\n    const params = Object.fromEntries(formData.entries());\n\n    if (!params.q && !params.track_name) {\n      showError($('#search-results'), 'Please provide at least a search query or track name');\n      return;\n    }\n\n    const container = $('#search-results');\n    showLoading(container);\n\n    try {\n      const qs = buildQueryString(params);\n      const data = await apiFetch(`/search?${qs}`);\n      renderSearchResults(data, container);\n    } catch (err) {\n      console.error('Search error:', err);\n      showError(container, getErrorMessage(err));\n    }\n  });\n\n  // Get by signature form\n  $('#form-get-signature').addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const form = e.target;\n    const formData = new FormData(form);\n    const params = Object.fromEntries(formData.entries());\n    const cached = params.cached;\n    delete params.cached;\n\n    const container = $('#get-results');\n    showLoading(container);\n\n    try {\n      const endpoint = cached ? '/get-cached' : '/get';\n      const qs = buildQueryString(params);\n      const data = await apiFetch(`${endpoint}?${qs}`);\n      renderLyrics(data, container);\n    } catch (err) {\n      if (err.status === 404) {\n        showError(container, 'Track not found. Make sure all fields match exactly, including duration (±2 seconds).');\n      } else {\n        showError(container, getErrorMessage(err));\n      }\n    }\n  });\n\n  // Get by ID form\n  $('#form-get-id').addEventListener('submit', async (e) => {\n    e.preventDefault();\n    const id = new FormData(e.target).get('id').trim();\n\n    const container = $('#get-results');\n    showLoading(container);\n\n    try {\n      const data = await apiFetch(`/get/${encodeURIComponent(id)}`);\n      renderLyrics(data, container);\n    } catch (err) {\n      if (err.status === 404) {\n        showError(container, 'Lyrics not found with this ID.');\n      } else {\n        showError(container, getErrorMessage(err));\n      }\n    }\n  });\n\n  // Publish - Challenge\n  $('#btn-challenge').addEventListener('click', async () => {\n    const status = $('#challenge-status');\n    status.className = 'challenge-status working';\n    status.textContent = 'Requesting challenge...';\n\n    try {\n      const data = await apiFetch('/request-challenge', { method: 'POST' });\n      currentChallenge = data;\n      $('#pub-prefix').value = data.prefix;\n      $('#pub-nonce').value = '';\n      $('#btn-solve').disabled = false;\n      status.className = 'challenge-status success';\n      status.textContent = `Challenge received! Prefix: ${data.prefix.substring(0, 16)}...Target: ${data.target.substring(0, 16)}...`;\n    } catch (err) {\n      status.className = 'challenge-status error';\n      status.textContent = 'Failed to get challenge:  ' + getErrorMessage(err);\n    }\n  });\n\n  // SHA-256 helper\n  async function sha256Hex(str) {\n    const data = new TextEncoder().encode(str);\n    const hash = await crypto.subtle.digest('SHA-256', data);\n    return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');\n  }\n\n  // Proof of work solver\n  async function solvePow(prefix, target, onProgress) {\n    let nonce = 0;\n    const batchSize = 2048;\n    const startTime = Date.now();\n\n    while (!solverCancel) {\n      for (let i = 0; i < batchSize && !solverCancel; i++) {\n        const input = `${prefix}: ${nonce}`;\n        const hash = await sha256Hex(input);\n\n        if (hash < target.toLowerCase()) {\n          return { nonce: String(nonce), hash, attempts: nonce + 1, time: Date.now() - startTime };\n        }\n        nonce++;\n      }\n\n      if (onProgress) {\n        onProgress(nonce, Date.now() - startTime);\n      }\n\n      // Yield to UI\n      await new Promise(r => setTimeout(r, 0));\n    }\n\n    throw new Error('Cancelled');\n  }\n\n  // Solve button\n  $('#btn-solve').addEventListener('click', async () => {\n    if (!currentChallenge) {\n      $('#challenge-status').textContent = 'Please request a challenge first';\n      return;\n    }\n\n    solverCancel = false;\n    solverWorking = true;\n    $('#btn-solve').disabled = true;\n    $('#btn-cancel').disabled = false;\n\n    const status = $('#challenge-status');\n    status.className = 'challenge-status working';\n\n    try {\n      const result = await solvePow(\n        currentChallenge.prefix,\n        currentChallenge.target,\n        (attempts, time) => {\n          const rate = Math.round(attempts / (time / 1000));\n          status.textContent = `Solving...${attempts.toLocaleString()} attempts (${rate.toLocaleString()} H/s)`;\n        }\n      );\n\n      $('#pub-nonce').value = result.nonce;\n      status.className = 'challenge-status success';\n      status.textContent = `Solved! Nonce: ${result.nonce} (${result.attempts.toLocaleString()} attempts in ${(result.time / 1000).toFixed(1)}s)`;\n    } catch (err) {\n      status.className = 'challenge-status error';\n      status.textContent = err.message === 'Cancelled' ? 'Solver cancelled' : `Solver error: ${err.message}`;\n    } finally {\n      solverWorking = false;\n      $('#btn-solve').disabled = false;\n      $('#btn-cancel').disabled = true;\n    }\n  });\n\n  // Cancel button\n  $('#btn-cancel').addEventListener('click', () => {\n    solverCancel = true;\n  });\n\n  // Publish form\n  $('#form-publish').addEventListener('submit', async (e) => {\n    e.preventDefault();\n\n    const formData = new FormData(e.target);\n    const data = Object.fromEntries(formData.entries());\n\n    const prefix = data.prefix;\n    const nonce = data.nonce;\n\n    if (!prefix || !nonce) {\n      showError($('#publish-results'), 'Please request and solve a challenge first');\n      return;\n    }\n\n    const token = `${prefix}:${nonce}`;\n    const body = {\n      trackName: data.trackName,\n      artistName: data.artistName,\n      albumName: data.albumName,\n      duration: parseInt(data.duration, 10),\n      plainLyrics: data.plainLyrics || '',\n      syncedLyrics: data.syncedLyrics || ''\n    };\n\n    const container = $('#publish-results');\n    showLoading(container);\n\n    try {\n      await apiFetch('/publish', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Publish-Token': token\n        },\n        body: JSON.stringify(body)\n      });\n\n      showSuccess(container, 'Lyrics published successfully!');\n\n      // Reset challenge\n      currentChallenge = null;\n      $('#pub-prefix').value = '';\n      $('#pub-nonce').value = '';\n      $('#btn-solve').disabled = true;\n      $('#challenge-status').textContent = '';\n    } catch (err) {\n      showError(container, getErrorMessage(err));\n    }\n  });\n\n  // Init\n  console.log('LRCGetter Frontend loaded');\n})();"],"names":["API_BASE","$","sel","$$","docEl","themeLogo","currentChallenge","solverCancel","THEME_STORAGE_KEY","themeButtons","systemDarkQuery","themePreference","getStoredTheme","initThemeControls","link","e","view","l","v","tab","tabName","tc","apiFetch","endpoint","options","url","headers","res","networkError","text","data","buildQueryString","params","_","k","err","setStoredTheme","value","getEffectiveTheme","pref","updateLogoForTheme","effectiveTheme","logoForDarkMode","logoForLightMode","applyThemePreference","btn","mode","handleSystemThemeChange","showLoading","container","showError","message","escapeHtml","showSuccess","str","div","formatDuration","seconds","m","s","getErrorMessage","copyToClipboard","payload","textarea","succeeded","renderLyrics","hasSynced","hasPlain","syncedHtml","line","match","plainHtml","t","type","copyButton","labelSpan","defaultLabel","setLabel","resetTimer","resetState","textSource","renderSearchResults","results","item","card","id","form","formData","qs","cached","status","sha256Hex","hash","b","solvePow","prefix","target","onProgress","nonce","batchSize","startTime","i","input","result","attempts","time","rate","token","body"],"mappings":"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"}